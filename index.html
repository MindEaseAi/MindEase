<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Calm Space</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
html,body{
  margin:0;
  height:100%;
  background:#050c0a;
  overflow:hidden;
  font-family:system-ui,-apple-system,Segoe UI,sans-serif;
}
canvas{position:fixed;inset:0;}
.ui{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
}
.panel{
  width:90%;
  max-width:720px;
  padding:38px;
  border-radius:32px;
  background:rgba(255,255,255,0.06);
  backdrop-filter:blur(24px);
  text-align:center;
  color:#e8f6f2;
}
.activity{
  font-size:22px;
  line-height:1.4;
  margin:30px 0;
  opacity:0;
  transition:opacity 1.2s;
}
.activity.show{opacity:1;}
button{
  padding:14px 36px;
  border-radius:999px;
  border:none;
  background:#6fd3c4;
  font-size:16px;
  color:#05302a;
  cursor:pointer;
}
.hidden{display:none;}
</style>
</head>
<body>

<canvas id="aurora"></canvas>

<div class="ui" id="ui">
  <div class="panel">
    <h1>Calm Space</h1>
    <div class="activity" id="activity"></div>
    <button id="next">Begin Session</button>
  </div>
</div>

<script>
/* ================= ACTIVITIES ================= */
const activitySets = [
  [
    "Notice the feeling of the air around you.",
    "Let your shoulders soften slightly.",
    "Allow your attention to drift without effort."
  ],
  [
    "Feel where your body makes contact with the ground.",
    "Observe any gentle movement within you.",
    "Let thoughts come and go without following them."
  ],
  [
    "Rest your attention on any sound you notice.",
    "Sense the space around your body.",
    "Release any need to change the moment."
  ]
];

let activities = [];
let index = -1;

const activityEl = document.getElementById("activity");
const nextBtn = document.getElementById("next");

nextBtn.onclick = () => {
  if(index === -1){
    startSession();
    nextBtn.innerText = "Next";
  }
  showNext();
};

function startSession(){
  activities = activitySets[Math.floor(Math.random()*activitySets.length)];
  index = 0;
}

function showNext(){
  if(index >= activities.length){
    activityEl.innerText = "Remain here as long as you like.";
    nextBtn.classList.add("hidden");
    return;
  }

  activityEl.classList.remove("show");
  setTimeout(()=>{
    activityEl.innerText = activities[index++];
    activityEl.classList.add("show");
  },400);
}

/* ================= AUDIO (CALM ENGINE) ================= */
let audioCtx, masterGain;

audioCtx = new (window.AudioContext||window.webkitAudioContext)();
masterGain = audioCtx.createGain();
masterGain.gain.value = 0.03;
masterGain.connect(audioCtx.destination);

function generateSound(){
  const base = 60 + Math.random()*60;

  for(let i=0;i<4;i++){
    const osc = audioCtx.createOscillator();
    osc.type="sine";
    osc.frequency.value = base*(1+Math.random()*0.35);

    const gain = audioCtx.createGain();
    gain.gain.value = 0;

    const lfo = audioCtx.createOscillator();
    lfo.frequency.value = 0.03 + Math.random()*0.02;
    const lfoGain = audioCtx.createGain();
    lfoGain.gain.value = 0.02;

    lfo.connect(lfoGain).connect(gain.gain);
    osc.connect(gain).connect(masterGain);

    osc.start();
    lfo.start();
    gain.gain.linearRampToValueAtTime(1,audioCtx.currentTime+6);
  }
}
generateSound();

/* ================= AURORA ================= */
const canvas = document.getElementById("aurora");
const ctx2d = canvas.getContext("2d");
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
window.onresize=resize; resize();

let t=Math.random()*1000;
function draw(){
  t+=0.002;
  ctx2d.clearRect(0,0,canvas.width,canvas.height);
  for(let i=0;i<3;i++){
    const y=canvas.height*(0.3+i*0.2);
    ctx2d.beginPath();
    ctx2d.moveTo(0,y);
    for(let x=0;x<=canvas.width;x+=40){
      ctx2d.lineTo(x,y+Math.sin(x*0.002+t*2+i)*80);
    }
    const g=ctx2d.createLinearGradient(0,y-120,0,y+120);
    g.addColorStop(0,"rgba(111,211,196,0)");
    g.addColorStop(0.5,"rgba(111,211,196,0.18)");
    g.addColorStop(1,"rgba(111,211,196,0)");
    ctx2d.strokeStyle=g;
    ctx2d.lineWidth=140;
    ctx2d.stroke();
  }
  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
